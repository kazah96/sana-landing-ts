{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/tema/projects/sana-landing-ts/blog/src/components/video-thumbnail/index.tsx\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { PureComponent } from \"react\";\nimport style from \"./style.module.css\";\nimport PropTypes from \"prop-types\";\nimport cn from \"classnames\";\n\nvar VideoThumbnail = /*#__PURE__*/function (_PureComponent) {\n  _inherits(VideoThumbnail, _PureComponent);\n\n  var _super = _createSuper(VideoThumbnail);\n\n  function VideoThumbnail(props) {\n    var _this;\n\n    _classCallCheck(this, VideoThumbnail);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      isLoading: true\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"hasLoaded\", function () {\n      clearInterval(_this.timer);\n\n      _this.setState({\n        isLoading: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"checkReady\", function () {\n      var vid = _this.video.current;\n\n      if (vid) {\n        if (vid.readyState > 3) {\n          _this.hasLoaded();\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onMouseEnter\", function () {\n      var vid = _this.video.current;\n\n      if (vid) {\n        vid.play();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onMouseLeave\", function () {\n      var vid = _this.video.current;\n\n      if (vid) {\n        vid.pause();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onLoad\", function () {\n      _this.hasLoaded();\n    });\n\n    _this.video = /*#__PURE__*/React.createRef();\n\n    _this.checkReady();\n\n    _this.timer = setInterval(function () {\n      _this.checkReady();\n    }, 700);\n    return _this;\n  }\n\n  _createClass(VideoThumbnail, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          imgUrl = _this$props.imgUrl,\n          webmUrl = _this$props.webmUrl,\n          name = _this$props.name;\n      var isLoading = this.state.isLoading;\n      var thumbClass = style.thumbnail;\n      var videoClass = cn(style.img, _defineProperty({}, style.hide, isLoading));\n      return __jsx(\"span\", {\n        className: thumbClass,\n        role: \"link\",\n        onMouseEnter: this.onMouseEnter,\n        onMouseLeave: this.onMouseLeave,\n        tabIndex: 0,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 7\n        }\n      }, __jsx(\"video\", {\n        ref: this.video,\n        onError: this.hasLoaded\n        /* Костыль для того чтоб на айфоне лоадер отрабатывал нормально. Нужно пофиксить в дальнейшем*/\n        ,\n        onCanPlayThrough: this.onLoad,\n        onCanPlay: this.onLoad,\n        loop: true,\n        poster: imgUrl,\n        muted: true,\n        className: videoClass,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 9\n        }\n      }, __jsx(\"source\", {\n        src: webmUrl,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }\n      }), __jsx(\"source\", {\n        src: imgUrl,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }\n      })), __jsx(\"div\", {\n        className: \"label\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 9\n        }\n      }, name));\n    }\n  }]);\n\n  return VideoThumbnail;\n}(PureComponent);\n\n_defineProperty(VideoThumbnail, \"propTypes\", {\n  id: PropTypes.number,\n  imgUrl: PropTypes.string,\n  webmUrl: PropTypes.string,\n  name: PropTypes.string,\n  defaultActive: PropTypes.bool\n});\n\nexport default VideoThumbnail;","map":{"version":3,"sources":["/home/tema/projects/sana-landing-ts/blog/src/components/video-thumbnail/index.tsx"],"names":["React","PureComponent","style","PropTypes","cn","VideoThumbnail","props","isLoading","clearInterval","timer","setState","vid","video","current","readyState","hasLoaded","play","pause","createRef","checkReady","setInterval","imgUrl","webmUrl","name","state","thumbClass","thumbnail","videoClass","img","hide","onMouseEnter","onMouseLeave","onLoad","id","number","string","defaultActive","bool"],"mappings":"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","sourcesContent":["import React, { PureComponent } from \"react\"\nimport style from \"./style.module.css\"\nimport PropTypes from \"prop-types\"\nimport cn from \"classnames\"\n\nclass VideoThumbnail extends PureComponent {\n  constructor(props) {\n    super(props)\n\n    this.video = React.createRef()\n    this.checkReady()\n    this.timer = setInterval(() => {\n      this.checkReady()\n    }, 700)\n  }\n\n  static propTypes = {\n    id: PropTypes.number,\n    imgUrl: PropTypes.string,\n    webmUrl: PropTypes.string,\n    name: PropTypes.string,\n    defaultActive: PropTypes.bool\n  }\n  state = {\n    isLoading: true\n  }\n\n  hasLoaded = () => {\n    clearInterval(this.timer)\n    this.setState({ isLoading: false })\n  }\n\n  checkReady = () => {\n    const vid = this.video.current\n    if (vid) {\n      if (vid.readyState > 3) {\n        this.hasLoaded()\n      }\n    }\n  }\n\n  onMouseEnter = () => {\n    const vid = this.video.current\n    if (vid) {\n      vid.play()\n    }\n  }\n\n  onMouseLeave = () => {\n    const vid = this.video.current\n    if (vid) {\n      vid.pause()\n    }\n  }\n\n  onLoad = () => {\n    this.hasLoaded()\n  }\n\n  render() {\n    const { imgUrl, webmUrl, name } = this.props\n    const { isLoading } = this.state\n    const thumbClass = style.thumbnail\n    const videoClass = cn(style.img, { [style.hide]: isLoading })\n\n    return (\n      <span\n        className={thumbClass}\n        role=\"link\"\n        onMouseEnter={this.onMouseEnter}\n        onMouseLeave={this.onMouseLeave}\n        tabIndex={0}\n      >\n        <video\n          ref={this.video}\n          onError={\n            this.hasLoaded\n          } /* Костыль для того чтоб на айфоне лоадер отрабатывал нормально. Нужно пофиксить в дальнейшем*/\n          onCanPlayThrough={this.onLoad}\n          onCanPlay={this.onLoad}\n          loop={true}\n          poster={imgUrl}\n          muted={true}\n          className={videoClass}\n        >\n          <source src={webmUrl} />\n          <source src={imgUrl} />\n          {/* Костыль для того чтоб на айфоне лоадер отрабатывал нормально. Нужно пофиксить в дальнейшем*/}\n        </video>\n        <div className=\"label\">{name}</div>\n      </span>\n    )\n  }\n}\n\nexport default VideoThumbnail\n"]},"metadata":{},"sourceType":"module"}